USE [master]
GO

DROP DATABASE IF EXISTS TestDB
GO

CREATE DATABASE TestDB
GO

USE TestDB
GO

	IF OBJECT_ID('dbo.DimDate')		IS NOT NULL DROP TABLE DimDate
	IF OBJECT_ID('dbo.FactActuals') IS NOT NULL DROP TABLE FactActuals
	IF OBJECT_ID('dbo.FactBudget')	IS NOT NULL DROP TABLE FactBudget
	IF OBJECT_ID('dbo.FactTarget')	IS NOT NULL DROP TABLE FactTarget

	CREATE TABLE DimDate
	(
			MonthKey	DATE NOT NULL	PRIMARY KEY
		,	QuarterKey	DATE NOT NULL
		,	YearKey		DATE NOT NULL

		,	MonthLabel		VARCHAR(8) NOT NULL
		,	QuarterLabel	VARCHAR(8) NOT NULL
		,	YearLabel		VARCHAR(4) NOT NULL
	)

	CREATE TABLE FactActuals
	(
			MonthKey	DATE	NOT NULL
		,	Amount		FLOAT	NOT NULL
	)

	CREATE TABLE FactBudget
	(
			QuarterKey	DATE	NOT NULL
		,	Amount		FLOAT	NOT NULL
	)

	CREATE TABLE FactTarget
	(
			YearKey	DATE	NOT NULL
		,	Amount	FLOAT	NOT NULL
	)

----------------------------------------------------------------

	INSERT INTO DimDate
	VALUES
		('20160101',	'20160101',	'20160101',	'2016 M01',	'2016 Q01',	'2016')
	,	('20160201',	'20160101',	'20160101',	'2016 M02',	'2016 Q01',	'2016')
	,	('20160301',	'20160101',	'20160101',	'2016 M03',	'2016 Q01',	'2016')
	,	('20160401',	'20160401',	'20160101',	'2016 M04',	'2016 Q02',	'2016')
	,	('20160501',	'20160401',	'20160101',	'2016 M05',	'2016 Q02',	'2016')
	,	('20160601',	'20160401',	'20160101',	'2016 M06',	'2016 Q02',	'2016')
	,	('20160701',	'20160701',	'20160101',	'2016 M07',	'2016 Q03',	'2016')
	,	('20160801',	'20160701',	'20160101',	'2016 M08',	'2016 Q03',	'2016')
	,	('20160901',	'20160701',	'20160101',	'2016 M09',	'2016 Q03',	'2016')
	,	('20161001',	'20161001',	'20160101',	'2016 M10',	'2016 Q04',	'2016')
	,	('20161101',	'20161001',	'20160101',	'2016 M11',	'2016 Q04',	'2016')
	,	('20161201',	'20161001',	'20160101',	'2016 M12',	'2016 Q04',	'2016')
	,	('20170101',	'20170101',	'20170101',	'2017 M01',	'2017 Q01',	'2017')
	,	('20170201',	'20170101',	'20170101',	'2017 M02',	'2017 Q01',	'2017')
	,	('20170301',	'20170101',	'20170101',	'2017 M03',	'2017 Q01',	'2017')
	,	('20170401',	'20170401',	'20170101',	'2017 M04',	'2017 Q02',	'2017')
	,	('20170501',	'20170401',	'20170101',	'2017 M05',	'2017 Q02',	'2017')
	,	('20170601',	'20170401',	'20170101',	'2017 M06',	'2017 Q02',	'2017')
	,	('20170701',	'20170701',	'20170101',	'2017 M07',	'2017 Q03',	'2017')
	,	('20170801',	'20170701',	'20170101',	'2017 M08',	'2017 Q03',	'2017')
	,	('20170901',	'20170701',	'20170101',	'2017 M09',	'2017 Q03',	'2017')
	,	('20171001',	'20171001',	'20170101',	'2017 M10',	'2017 Q04',	'2017')
	,	('20171101',	'20171001',	'20170101',	'2017 M11',	'2017 Q04',	'2017')
	,	('20171201',	'20171001',	'20170101',	'2017 M12',	'2017 Q04',	'2017')
	,	('20180101',	'20180101',	'20180101',	'2018 M01',	'2018 Q01',	'2018')
	,	('20180201',	'20180101',	'20180101',	'2018 M02',	'2018 Q01',	'2018')
	,	('20180301',	'20180101',	'20180101',	'2018 M03',	'2018 Q01',	'2018')
	,	('20180401',	'20180401',	'20180101',	'2018 M04',	'2018 Q02',	'2018')
	,	('20180501',	'20180401',	'20180101',	'2018 M05',	'2018 Q02',	'2018')
	,	('20180601',	'20180401',	'20180101',	'2018 M06',	'2018 Q02',	'2018')
	,	('20180701',	'20180701',	'20180101',	'2018 M07',	'2018 Q03',	'2018')
	,	('20180801',	'20180701',	'20180101',	'2018 M08',	'2018 Q03',	'2018')
	,	('20180901',	'20180701',	'20180101',	'2018 M09',	'2018 Q03',	'2018')
	,	('20181001',	'20181001',	'20180101',	'2018 M10',	'2018 Q04',	'2018')
	,	('20181101',	'20181001',	'20180101',	'2018 M11',	'2018 Q04',	'2018')
	,	('20181201',	'20181001',	'20180101',	'2018 M12',	'2018 Q04',	'2018')

	INSERT INTO FactActuals	(	MonthKey,	Amount		)
	VALUES
		('20160101',	14122.32)
	,	('20160201',	14128.86)
	,	('20160301',	10746.61)
	,	('20160401',	11526.24)
	,	('20160501',	10068.32)
	,	('20160601',	14540.55)
	,	('20160701',	12738.31)
	,	('20160801',	11930.69)
	,	('20160901',	12480.67)
	,	('20161001',	14896.35)
	,	('20161101',	10709.87)
	,	('20161201',	13283.31)
	,	('20170101',	12843.92)
	,	('20170201',	11855.16)
	,	('20170301',	14781.69)
	,	('20170401',	13818.84)
	,	('20170501',	12976.41)
	,	('20170601',	12667.60)
	,	('20170701',	11562.17)
	,	('20170801',	14906.04)
	,	('20170901',	13420.77)
	,	('20171001',	10027.37)
	,	('20171101',	14674.39)
	,	('20171201',	14231.50)

	INSERT INTO FactBudget	(	QuarterKey,	Amount		)
	VALUES
		('20160101',37500)
	,	('20160401',37500)
	,	('20160701',37500)
	,	('20161001',37500)
	
	,	('20170101',40000)
	,	('20170401',40000)
	,	('20170701',40000)
	,	('20171001',40000)

	,	('20180101',42500)
	,	('20180401',42500)
	,	('20180701',42500)
	,	('20181001',42500)

	INSERT INTO FactTarget	(	YearKey,	Amount		)
	VALUES
		('20160101',140000),
		('20170101',155000),
		('20180101',160000)































