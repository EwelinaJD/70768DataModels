
--------------------------------------------------------------------------------------------------------------------------------
--	UNION
--------------------------------------------------------------------------------------------------------------------------------

--	Returns a set that is generated by the union of two sets, optionally retaining duplicate members.
--	This function returns the union of two or more specified sets. 
--	With the standard syntax and with alternate syntax 1, duplicates are eliminated by default. 
--	With the standard syntax, using the ALL flag keeps duplicates in the joined set. Duplicates are deleted from the tail of the set. 
--	With alternate syntax 2, duplicates are always retained.
--------------------------------------------------------------------------------------------------------------------------------

	-- dwa zbiory na tym samym poziomie

	SELECT
		[Measures].[Reseller Sales Amount] ON 0,
		UNION(	[Geography].[Geography].[Country].&[Germany].Children,
				[Geography].[Geography].[Country].&[France].Children
				)
	ON 1
	FROM [Adventure Works]
	; 

	--	dwa zbiory na ró¿nych poziomach tej samej hierarchii

	SELECT
		[Measures].[Reseller Sales Amount] ON 0,
		UNION(	[Geography].[Geography].[Country].&[Germany].Children,
				[Geography].[Geography].[Country].MEMBERS
				)
	ON 1
	FROM [Adventure Works]
	; 

	--	dodajemy miarê, ¿eby sprawdziæ na jakim poziomie hierarchii jest member

	WITH MEMBER [Measures].[CMLevel]
	AS
		[Geography].[Geography].CURRENTMEMBER.LEVEL.ORDINAL
	SELECT
		{	[Measures].[Reseller Sales Amount],
			[Measures].[CMLevel]
			} ON 0,
		UNION(	[Geography].[Geography].[Country].&[Germany].Children,
				[Geography].[Geography].[Country].MEMBERS
				)
	ON 1
	FROM [Adventure Works]
	; 

	--	ORDER malej¹cy zachowuj¹cy hierarchiê

	WITH MEMBER [Measures].[CMLevel]
	AS
		[Geography].[Geography].CURRENTMEMBER.LEVEL.ORDINAL
	SELECT
		{	[Measures].[Reseller Sales Amount],
			[Measures].[CMLevel]
			} ON 0,
		ORDER(	UNION(	[Geography].[Geography].[Country].&[Germany].Children,
						[Geography].[Geography].[Country].&[France].Children,
						[Geography].[Geography].[Country].MEMBERS
						),
				[Measures].[CMLevel],
				ASC
				)
	ON 1
	FROM [Adventure Works]
	; 

	--	ORDER malej¹cy ³ami¹cy hierarchiê

	WITH MEMBER [Measures].[CMLevel]
	AS
		[Geography].[Geography].CURRENTMEMBER.LEVEL.ORDINAL
	SELECT
		{	[Measures].[Reseller Sales Amount],
			[Measures].[CMLevel]
			} ON 0,
		ORDER(	UNION(	[Geography].[Geography].[Country].&[Germany].Children,
						[Geography].[Geography].[Country].&[France].Children,
						[Geography].[Geography].[Country].MEMBERS
						),
				[Measures].[CMLevel],
				BASC
				)
	ON 1
	FROM [Adventure Works]
	; 

----------------------------------------------------------------
-- UNION vs. UNION ALL (jak SQL)
----------------------------------------------------------------

	SELECT
		[Measures].[Reseller Sales Amount] ON 0,
		UNION(	[Product].[Product Categories].[Subcategory].[Socks].Children,
				[Product].[Product Categories].[Subcategory].[Socks].Children
			) ON 1
	FROM [Adventure Works]; 

	SELECT
		[Measures].[Reseller Sales Amount] ON 0,
		UNION(	[Product].[Product Categories].[Subcategory].[Socks].Children,
				[Product].[Product Categories].[Subcategory].[Socks].Children,
			ALL
			) ON 1
	FROM [Adventure Works]; 

----------------------------------------------------------------
-- OPERATORY {+} oraz {,}
----------------------------------------------------------------

	SELECT
		[Measures].[Reseller Sales Amount] ON 0,
		UNION(	[Product].[Product Categories].[Subcategory].[Socks].CHILDREN	,
				[Product].[Product Categories].[Subcategory].[Socks].CHILDREN
			) ON 1
	FROM [Adventure Works]; 

	--	{+} = UNION
	--	{,} = UNION ALL

	SELECT
		[Measures].[Reseller Sales Amount] ON 0,
		{	[Product].[Product Categories].[Subcategory].[Socks].CHILDREN	,
			[Product].[Product Categories].[Subcategory].[Socks].CHILDREN
			} ON 1
	FROM [Adventure Works]
	; 

	SELECT
		[Measures].[Reseller Sales Amount] ON 0,
		{	[Product].[Product Categories].[Subcategory].[Socks].CHILDREN	+
			[Product].[Product Categories].[Subcategory].[Socks].CHILDREN
			} ON 1
	FROM [Adventure Works]
	; 
